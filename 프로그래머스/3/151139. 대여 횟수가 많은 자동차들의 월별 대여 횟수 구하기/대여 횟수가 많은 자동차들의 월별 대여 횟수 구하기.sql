SELECT MONTH(START_DATE) AS MONTH, CAR_ID, SUM(COUNT(*)) OVER (PARTITION BY CAR_ID, MONTH(START_DATE)) AS RECORDS
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
WHERE START_DATE >= '2022-08-01' AND START_DATE <='2022-10-31'
        AND CAR_ID IN (SELECT CAR_ID
                        FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
                        WHERE START_DATE >= '2022-08-01' AND START_DATE <='2022-10-31'
                        GROUP BY CAR_ID
                        HAVING COUNT(*)>=5)
GROUP BY CAR_ID, MONTH
ORDER BY MONTH ASC, CAR_ID DESC
